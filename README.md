# ruby2nem
Simple ruby class to access NEM (NIS &amp; NCC) api

NEM.rb cointains a simple ruby class that can be used
to send API calls to NIS (Nem Infrastructure Server)
and NCC (Nem Community Client).

## How to use

```ruby
#include the required class

require_relative 'NEM.rb'

#define the initial configuration parameters
#if not defined the defaults will be used
conf = {
    'nis_address' => '133.242.230.245',
    'nis_port'    => 7895,
}

#create an instance using a user defined configuration options
nem = NEM.new(conf)
```

you can also create the NEM object with the default options by not passing any
parameter in the constructor call

```ruby
nem = NEM.new()
```

you can then set the options at later stage in your code if needed with the set_options method:

```ruby
nem.set_options(conf)
```

to list all the configurations read the [config] variable:

```ruby
puts JSON.pretty_generate nem.config
```

the output should look like this:

```ruby
{
  "nis": {
    "address": "133.242.230.245",
    "port": 7895,
    "context": "/"
  },
  "ncc": {
    "address": "127.0.0.1",
    "port": 8989,
    "context": "/ncc/api/"
  }
}
```

or if called with a key parameter

```ruby
puts nem.config['nis']['port']
```

it returns a single scalar value of the requested option in this case:

```
7890
```

### making requests to NIS (Nem Infrastructure Server)

get request sample:

```ruby
puts nem.nis_get('/node/info')
```

the returned output is in a raw JSON format:

```
{"metaData"=>{"features"=>1, "application"=>nil, "networkId"=>96, "version"=>"0.6.67-BETA", "platform"=>"Oracle Corporation (1.8.0_66) on Linux"}, "endpoint"=>{"protocol"=>"http", "port"=>7895, "host"=>"133.242.230.245"}, "identity"=>{"name"=>"S1", "public-key"=>"7d7078b4ebc0affa73ce2ee934be32565e480d5c0feb427a50d16bbfd474bf85"}}
```

post request sample:

```ruby
# sample using a ruby hash
data = {height: 10_000}
puts nem.nis_post('/block/at/public',data)
```

the nis_post and ncc_post methods accept parameters in the JSON format:

```ruby
# sample using JSON formatted text
data = '{"height": 10000}'
puts nem.nis_post('/block/at/public',data)
```

the returned output is in a raw JSON format:

```ruby
{"timeStamp"=>25929260, "signature"=>"c6397d94de9572b394ff4d75cca5dfb706737693e4552d443e5e69e7e75ac3b6691fbb6120abb7c195ad2393c586ba8fd6c03558437fbf971ac24b4fd14fe009", "prevBlockHash"=>{"data"=>"393ab4b451e6c43f0bbed220e714710406a93b40de3a29eacc957c999a5c9b38"}, "type"=>1, "transactions"=>[], "version"=>1610612737, "signer"=>"26ac2fc6bf84493f7a07b791408507c55827f5f5ed5d4fe4ec5eb1ee4bbf7961", "height"=>10000}
```

the response from NIS or NCC is in the ruby hash format:

```ruby
data = '{"height": 10000}'
block = nem.nis_post('/block/at/public',data);

#you can now use the $block variable further in your ruby code
puts block['timeStamp'];
```

### making requests to NCC (Nem Community Client)

get request sample:

```ruby
puts nem.ncc_get('/info/ncc')
```

the returned output is in a raw JSON format:

```ruby
{"metaData":{"currentTime":2913152,"application":"NEM Deploy","startTime":2912577,"version":"0.6.28-BETA","signer":null},"remoteServer":"http:\/\/go.nem.ninja:7890\/","language":"en"}

```

post request sample:

```ruby
data =
{
    "data": {
        "protocol": "http",
        "host": "bob.nem.ninja",
        "port": 7890
    }
}.to_json

puts nem.ncc_post('/network',data);
```

the returned output is in a raw JSON format:

```ruby
{"meta":{"meta":[{"endpoint":{"protocol":"http","port":7890,"host":"107.179.25.32"},"address":"NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF","active":1,"version":"0.6.28-BETA","platform":"Oracle Corporation (1.8.0_40) on Linux"},{"endpoint":{"protocol":"http","port":7890,"host":"37.187.70.29"},"address":"ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS","active":1,"version":"0.6.28-BETA","platform":"Oracle Corporation (1.8.0_40) on Linux"}]},"graph":{"nodes":[{"id":"NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF","label":"Hi, I am MedAlice2"},{"id":"ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS","label":"bob.nem.ninja"}],"edges":[{"id":"ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS-NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF","source":"ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS","target":"NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF"}]}}
```

(The pretty JSON ouputs are generated by JSON.pretty_generate.)

```ruby
{
    "meta": {
        "meta": [
            {
                "endpoint": {
                    "protocol": "http",
                    "port": 7890,
                    "host": "107.179.25.32"
                },
                "address": "NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF",
                "active": 1,
                "version": "0.6.28-BETA",
                "platform": "Oracle Corporation (1.8.0_40) on Linux"
            },
            {
                "endpoint": {
                    "protocol": "http",
                    "port": 7890,
                    "host": "37.187.70.29"
                },
                "address": "ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS",
                "active": 1,
                "version": "0.6.28-BETA",
                "platform": "Oracle Corporation (1.8.0_40) on Linux"
            }
        ]
    },
    "graph": {
        "nodes": [
            {
                "id": "NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF",
                "label": "Hi, I am MedAlice2"
            },
            {
                "id": "ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS",
                "label": "bob.nem.ninja"
            }
        ],
        "edges": [
            {
                "id": "ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS-NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF",
                "source": "ND75VR7ZKB4G45Q4HJPPSEHQKIYYKQXQ7VW4JORS",
                "target": "NALICEROONSJCPHC63F52V6FY3SDMSVAEWH3QUJF"
            }
        ]
    }
}
```

## Documentation

for more detailed information about the NIS and NCC api please visit the following links:

* [NIS API documentation](http://bob.nem.ninja/docs/)
* [NCC API documentation](https://github.com/NewEconomyMovement/NemCommunityClient/blob/master/docs/api.md)
